const d="/api";async function w(e){const t=await fetch(`${d}/brief/parse`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brief_text:e})});if(!t.ok)throw new Error(`Failed to parse brief: ${t.statusText}`);return t.json()}async function b(e,t,o){const n=await fetch(`${d}/brief/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brief:e,conversation_id:t,user_id:o||"anonymous"})});if(!n.ok)throw new Error(`Failed to confirm brief: ${n.statusText}`);return n.json()}async function*g(e,t,o){var i;const n=await fetch(`${d}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,conversation_id:t,user_id:o||"anonymous"})});if(!n.ok)throw new Error(`Chat request failed: ${n.statusText}`);const r=(i=n.body)==null?void 0:i.getReader();if(!r)throw new Error("No response body");const f=new TextDecoder;let c="";for(;;){const{done:u,value:y}=await r.read();if(u)break;c+=f.decode(y,{stream:!0});const h=c.split(`

`);c=h.pop()||"";for(const a of h)if(a.startsWith("data: ")){const s=a.slice(6);if(s==="[DONE]")return;try{yield JSON.parse(s)}catch{console.error("Failed to parse SSE data:",s)}}}}async function*S(e,t,o=!0,n){var u;const r=await fetch(`${d}/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brief:e,products:t||[],generate_images:o,conversation_id:n})});if(!r.ok)throw new Error(`Content generation failed: ${r.statusText}`);const f=(u=r.body)==null?void 0:u.getReader();if(!f)throw new Error("No response body");const c=new TextDecoder;let i="";for(;;){const{done:y,value:h}=await f.read();if(y)break;i+=c.decode(h,{stream:!0});const a=i.split(`

`);i=a.pop()||"";for(const s of a)if(s.startsWith("data: ")){const l=s.slice(6);if(l==="[DONE]")return;try{yield JSON.parse(l)}catch{console.error("Failed to parse SSE data:",l)}}}}async function T(e){const t=new URLSearchParams;e!=null&&e.category&&t.set("category",e.category),e!=null&&e.sub_category&&t.set("sub_category",e.sub_category),e!=null&&e.search&&t.set("search",e.search),e!=null&&e.limit&&t.set("limit",e.limit.toString());const o=await fetch(`${d}/products?${t}`);if(!o.ok)throw new Error(`Failed to get products: ${o.statusText}`);return o.json()}export{b as confirmBrief,T as getProducts,w as parseBrief,g as streamChat,S as streamGenerateContent};
